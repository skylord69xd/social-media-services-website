<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | Social Media Services</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
    <style>
        .admin-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .btn-logout {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: auto;
        }
        .admin-header {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f5f5f5;
        }
        .vouch-management img {
            max-width: 300px;
            border: 1px solid #ddd;
        }
    </style>
    <script>
        // Strict authentication
        (function() {
            const MAX_ATTEMPTS = 3;
            let attempts = 0;
            
            if (!sessionStorage.getItem('adminAuth')) {
                while (attempts < MAX_ATTEMPTS) {
                    const password = prompt(`🔐 Admin Access (Attempt ${attempts + 1}/${MAX_ATTEMPTS})\nEnter Password:`);
                    
                    if (password === "SKYLORD@admin69dxv") {
                        sessionStorage.setItem('adminAuth', 'true');
                        document.getElementById('authTime').textContent = new Date().toLocaleString();
                        break;
                    }
                    
                    attempts++;
                    if (attempts >= MAX_ATTEMPTS) {
                        alert("🚨 Maximum attempts reached. System locked.");
                        window.location.href = "../";
                        return;
                    }
                }
            }
        })();
    </script>
</head>
<body>
    <div class="admin-header">
        <div class="logo-container">
            <img src="../assets/logos/your-logo.png" alt="Admin Logo" class="logo">
            <h1>Admin Panel <small id="authTime"></small></h1>
        </div>
        <button onclick="logout()" class="btn-logout">
            <i class="fas fa-sign-out-alt"></i> Logout
        </button>
    </div>

    <main class="admin-container">
        <section>
            <h2><i class="fas fa-check-circle"></i> Approved Feedback</h2>
            <div id="approved-feedback">
                <!-- Feedback loaded from localStorage -->
            </div>
        </section>
        
        <section class="vouch-management">
            <h2><i class="fas fa-image"></i> Manage Vouches</h2>
            <div id="vouches-management">
                <!-- Vouches loaded from localStorage -->
            </div>
            <h3>Add New Vouch</h3>
            <form id="add-vouch-form">
                <div class="form-group">
                    <label>Image URL:</label>
                    <input type="url" id="vouch-image-url" required>
                </div>
                <div class="form-group">
                    <label>Description (optional):</label>
                    <input type="text" id="vouch-desc">
                </div>
                <button type="submit" class="btn">Add Vouch</button>
            </form>
        </section>
        
        <section>
            <h2><i class="fas fa-comments"></i> Pending Feedback</h2>
            <div id="pending-feedback">
                <!-- Pending feedback loaded from localStorage -->
            </div>
        </section>
    </main>

    <script>
        // Admin functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Load approved feedback
            const approvedFeedback = JSON.parse(localStorage.getItem('approvedFeedback')) || [];
            document.getElementById('approved-feedback').innerHTML = approvedFeedback.map(fb => `
                <div class="feedback-item">
                    <p><strong>${fb.name || 'Anonymous'}</strong> (${'★'.repeat(fb.rating)}${'☆'.repeat(5 - fb.rating)})</p>
                    <p>${fb.message}</p>
                    <button onclick="removeFeedback(${fb.timestamp})" class="btn-reject">Delete</button>
                </div>
            `).join('');
            
            // Load vouches
            const vouches = JSON.parse(localStorage.getItem('vouches')) || [];
            document.getElementById('vouches-management').innerHTML = vouches.map(vouch => `
                <div class="vouch-item">
                    <img src="${vouch.imageUrl}" alt="Vouch">
                    <p>${vouch.description || ''}</p>
                    <button onclick="removeVouch('${vouch.imageUrl}')" class="btn-reject">Delete</button>
                </div>
            `).join('');
            
            // Load pending feedback
            const pendingFeedback = JSON.parse(localStorage.getItem('pendingFeedback')) || [];
            document.getElementById('pending-feedback').innerHTML = pendingFeedback.map(fb => `
                <div class="feedback-item">
                    <p><strong>${fb.name || 'Anonymous'}</strong> (${'★'.repeat(fb.rating)}${'☆'.repeat(5 - fb.rating)})</p>
                    <p>${fb.message}</p>
                    <div class="feedback-actions">
                        <button onclick="approveFeedback(${fb.timestamp})" class="btn-approve">Approve</button>
                        <button onclick="rejectFeedback(${fb.timestamp})" class="btn-reject">Reject</button>
                    </div>
                </div>
            `).join('');
            
            // Add vouch form
            document.getElementById('add-vouch-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const newVouch = {
                    imageUrl: document.getElementById('vouch-image-url').value,
                    description: document.getElementById('vouch-desc').value
                };
                const vouches = JSON.parse(localStorage.getItem('vouches')) || [];
                vouches.push(newVouch);
                localStorage.setItem('vouches', JSON.stringify(vouches));
                alert('Vouch added!');
                location.reload();
            });
        });
        
        function logout() {
            sessionStorage.removeItem('adminAuth');
            window.location.href = "../";
        }
        
        function approveFeedback(timestamp) {
            const pending = JSON.parse(localStorage.getItem('pendingFeedback')) || [];
            const approved = JSON.parse(localStorage.getItem('approvedFeedback')) || [];
            
            const feedback = pending.find(fb => fb.timestamp === timestamp);
            if (feedback) {
                approved.push(feedback);
                localStorage.setItem('approvedFeedback', JSON.stringify(approved));
                localStorage.setItem('pendingFeedback', JSON.stringify(pending.filter(fb => fb.timestamp !== timestamp)));
                location.reload();
            }
        }
        
        function rejectFeedback(timestamp) {
            const pending = JSON.parse(localStorage.getItem('pendingFeedback')) || [];
            localStorage.setItem('pendingFeedback', JSON.stringify(pending.filter(fb => fb.timestamp !== timestamp)));
            location.reload();
        }
        
        function removeFeedback(timestamp) {
            const approved = JSON.parse(localStorage.getItem('approvedFeedback')) || [];
            localStorage.setItem('approvedFeedback', JSON.stringify(approved.filter(fb => fb.timestamp !== timestamp)));
            location.reload();
        }
        
        function removeVouch(imageUrl) {
            const vouches = JSON.parse(localStorage.getItem('vouches')) || [];
            localStorage.setItem('vouches', JSON.stringify(vouches.filter(v => v.imageUrl !== imageUrl)));
            location.reload();
        }
    </script>
</body>
</html>